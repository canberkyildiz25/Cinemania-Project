{"version":3,"file":"catalog-D9wIxm5C.js","sources":["../../src/app/components/pagination/pagination.js","../../src/app/pages/catalog/catalog.js"],"sourcesContent":["/**\n * Sayfalama (pagination) component'ini oluşturur ve DOM'a basar.\n * @param {HTMLElement} container - Butonların basılacağı div\n * @param {number} totalPages - Toplam sayfa sayısı\n * @param {number} currentPage - Aktif sayfa\n * @param {Function} onPageChange - Sayfa değiştiğinde çağrılacak fonksiyon (yeni sayfa numarasını alır)\n */\nexport function setupPagination(\n  container,\n  totalPages,\n  currentPage,\n  onPageChange\n) {\n  if (!container || totalPages <= 1) {\n    if (container) container.innerHTML = ''; // Sayfalama gerekmiyorsa temizle\n    return;\n  }\n\n  container.innerHTML = '';\n  const maxButtons = 5; // Ekranda görünecek maks sayfa butonu\n\n  // Hangi sayfa numarasından başlayacağını hesapla\n  let start = Math.max(currentPage - 2, 1);\n  let end = Math.min(start + maxButtons - 1, totalPages);\n\n  // Eğer sona yaklaşıldıysa (örn. 50 sayfa varken 49. sayfadaysan),\n  // 46, 47, 48, 49, 50 göstermek için başlangıcı ayarla\n  if (end - start < maxButtons - 1) {\n    start = Math.max(end - maxButtons + 1, 1);\n  }\n\n  // --- 1. Sol Ok (Geri) ---\n  const prev = document.createElement('button');\n  prev.className = 'pagination-arrow';\n  prev.innerHTML = '&laquo;'; // «\n  prev.disabled = currentPage === 1; // İlk sayfadaysa pasif\n  prev.addEventListener('click', () => onPageChange(currentPage - 1));\n  container.appendChild(prev);\n\n  // --- 2. Sayfa Numaraları ---\n\n  // Gerekirse '1 ...' ekle\n  if (start > 1) {\n    container.appendChild(createPageButton(1, onPageChange));\n    if (start > 2) {\n      container.appendChild(createDots());\n    }\n  }\n\n  // Ana sayfa butonları (örn. 10, 11, 12, 13, 14)\n  for (let i = start; i <= end; i++) {\n    const btn = createPageButton(i, onPageChange, i === currentPage);\n    container.appendChild(btn);\n  }\n\n  // Gerekirse '... 50' ekle\n  if (end < totalPages) {\n    if (end < totalPages - 1) {\n      container.appendChild(createDots());\n    }\n    container.appendChild(createPageButton(totalPages, onPageChange));\n  }\n\n  // --- 3. Sağ Ok (İleri) ---\n  const next = document.createElement('button');\n  next.className = 'pagination-arrow';\n  next.innerHTML = '&raquo;'; // »\n  next.disabled = currentPage === totalPages; // Son sayfadaysa pasif\n  next.addEventListener('click', () => onPageChange(currentPage + 1));\n  container.appendChild(next);\n}\n\n// --- Yardımcı Fonksiyonlar (pagination.js için) ---\n\n/**\n * Tıklanabilir bir sayfa butonu oluşturur\n * @private\n */\nfunction createPageButton(page, onClick, isActive = false) {\n  const btn = document.createElement('button');\n  btn.className = 'pagination-btn';\n  if (isActive) btn.classList.add('active');\n  btn.textContent = page;\n  btn.addEventListener('click', () => onClick(page));\n  return btn;\n}\n\n/**\n * '...' elementini oluşturur\n * @private\n */\nfunction createDots() {\n  const dots = document.createElement('span');\n  dots.className = 'pagination-dots';\n  dots.textContent = '...';\n  return dots;\n}","// src/app/pages/catalog/catalog.js\nimport {\n  searchMovies,\n  fetchPopularMovies,\n} from '../../data/movies-data.js';\nimport { setupPagination } from '../../components/pagination/pagination.js';\nimport { showLoader, hideLoader } from '../../common/loader.js';\nimport { renderMovieCard, updateHeroWithMovie } from '../../common/ui-helpers.js';\n\nconst initCatalog = async () => {\n  const form = document.getElementById('search-form');\n  const input = document.getElementById('search-input');\n  const movieGrid = document.getElementById('movie-grid');\n  const paginationContainer = document.querySelector('.pagination');\n  const heroSection = document.getElementById('catalog-hero');\n  const heroContent = document.getElementById('catalog-hero-content');\n\n  // --- YENİ DROPDOWN ELEMENTLERİ ---\n  const dropdown = document.getElementById('year-dropdown');\n  const dropdownHeader = document.getElementById('dropdown-header');\n  const dropdownList = document.getElementById('dropdown-list');\n  const selectedYearSpan = document.getElementById('selected-year');\n  const yearInput = document.getElementById('year-input'); // Gizli input\n\n  if (!movieGrid) return; // Katalog sayfasında değilsek dur\n\n  // --- YILLARI LİSTEYE DOLDURMA ---\n  const currentYear = new Date().getFullYear();\n\n  if (dropdownList) {\n    // 1. En başa \"Year (All)\" seçeneği ekle (Sıfırlamak için)\n    const resetLi = document.createElement('li');\n    resetLi.classList.add('dropdown-item'); // CSS'teki sınıf\n    resetLi.textContent = \"Year\";\n    \n    resetLi.onclick = () => {\n      if (yearInput) yearInput.value = \"\"; // Değeri temizle\n      if (selectedYearSpan) {\n        selectedYearSpan.textContent = \"Year\";\n        selectedYearSpan.style.color = \"\"; // Rengi sıfırla\n      }\n      closeDropdown();\n    };\n    dropdownList.appendChild(resetLi);\n\n    // 2. Yılları döngü ile ekle\n    for (let y = currentYear; y >= 1950; y--) {\n      const li = document.createElement('li');\n      li.classList.add('dropdown-item'); // CSS'teki sınıf\n      li.textContent = y;\n      \n      // Yıla tıklanınca ne olacak?\n      li.onclick = () => {\n        if (yearInput) yearInput.value = y; // Gizli inputa yaz\n        if (selectedYearSpan) {\n          selectedYearSpan.textContent = y; // Ekranda göster\n          selectedYearSpan.style.color = \"var(--primary-orange)\"; // Seçili olduğunu belli et\n        }\n        closeDropdown();\n      };\n      \n      dropdownList.appendChild(li);\n    }\n  }\n\n  // --- DROPDOWN AÇMA / KAPAMA MANTIĞI ---\n  function toggleDropdown() {\n    if (dropdown) dropdown.classList.toggle('active'); // Ok işaretini döndürür\n    if (dropdownList) dropdownList.classList.toggle('is-hidden'); // Listeyi açar/kapatır\n  }\n\n  function closeDropdown() {\n    if (dropdown) dropdown.classList.remove('active');\n    if (dropdownList) dropdownList.classList.add('is-hidden');\n  }\n\n  // Header'a tıklayınca aç/kapa\n  if (dropdownHeader) {\n    dropdownHeader.addEventListener('click', (e) => {\n      e.stopPropagation(); // Tıklamanın sayfa geneline yayılmasını engelle\n      toggleDropdown();\n    });\n  }\n\n  // Sayfada boş yere tıklayınca kapat\n  document.addEventListener('click', (e) => {\n    if (dropdown && !dropdown.contains(e.target)) {\n      closeDropdown();\n    }\n  });\n\n  // --- DEĞİŞKENLER ---\n  let currentPage = 1;\n  let lastQuery = '';\n  let lastYear = '';\n  let totalPages = 1;\n\n  // --- BAŞLANGIÇ FİLMLERİ ---\n  async function loadInitialMovies() {\n    showLoader();\n    const data = await fetchPopularMovies(1);\n    hideLoader();\n\n    if (data?.results?.length) {\n      renderMovies(data.results);\n      if (data.results[0]) {\n        await updateHeroWithMovie(data.results[0].id, heroSection, heroContent);\n      }\n    }\n  }\n\n  // --- ARAMA İŞLEMİ ---\n  if (form) {\n    form.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const query = input.value.trim();\n      \n      // DİKKAT: Artık select yok, gizli input'tan değeri alıyoruz\n      const year = yearInput ? yearInput.value : ''; \n\n      if (!query) return;\n\n      currentPage = 1;\n      lastQuery = query;\n      lastYear = year;\n      \n      // Arama yaparken dropdown açıksa kapatalım\n      closeDropdown(); \n      \n      await fetchAndRenderMovies(query, year, currentPage);\n    });\n  }\n\n  async function fetchAndRenderMovies(query, year, page) {\n    showLoader();\n    const data = await searchMovies(query, page, year);\n    hideLoader();\n\n if (!data?.results?.length) {\n      // Görseldeki tasarıma uygun HTML yapısı\n      movieGrid.innerHTML = `\n        <div class=\"no-results-container\">\n          <h2 class=\"no-results-title\">OOPS...</h2>\n          <h3 class=\"no-results-text\">We are very sorry!</h3>\n          <h3 class=\"no-results-text\">We don’t have any results matching your search.</h3>\n        </div>\n      `;\n      paginationContainer.innerHTML = '';\n      heroContent.innerHTML = '';\n      heroSection.style.backgroundImage = 'none';\n      return;\n    }\n    totalPages = data.total_pages;\n    renderMovies(data.results);\n\n    if (data.results[0]) {\n      await updateHeroWithMovie(data.results[0].id, heroSection, heroContent);\n    }\n\n    setupPagination(paginationContainer, totalPages, page, (newPage) => {\n      currentPage = newPage;\n      fetchAndRenderMovies(lastQuery, lastYear, newPage);\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    });\n  }\n\n  function renderMovies(list) {\n    movieGrid.innerHTML = list.map((m) => renderMovieCard(m)).join('');\n  }\n\n  movieGrid.addEventListener('click', (e) => {\n    const card = e.target.closest('.movie-card');\n    if (card && card.dataset.id) {\n      updateHeroWithMovie(card.dataset.id, heroSection, heroContent);\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  });\n\n  await loadInitialMovies();\n};\n\ninitCatalog();"],"names":["setupPagination","container","totalPages","currentPage","onPageChange","maxButtons","start","end","prev","createPageButton","createDots","i","btn","next","page","onClick","isActive","dots","initCatalog","form","input","movieGrid","paginationContainer","heroSection","heroContent","dropdown","dropdownHeader","dropdownList","selectedYearSpan","yearInput","currentYear","resetLi","closeDropdown","y","li","toggleDropdown","lastQuery","lastYear","loadInitialMovies","showLoader","data","fetchPopularMovies","hideLoader","renderMovies","updateHeroWithMovie","query","year","fetchAndRenderMovies","searchMovies","newPage","list","m","renderMovieCard","card"],"mappings":"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"}